// Preprocessor directives
{% for directive in preprocessor_directives %}
{{ directive }}
{% endfor %}

// CUDA-specific includes and defines
#ifdef __CUDACC__
#include <cuda_runtime.h>
#include <device_launch_parameters.h>
#endif

// Platform-specific defines
{% if platform == "jetson" %}
#define JETSON_PLATFORM
#define USE_TENSORRT
{% elif platform == "x86" %}
#define X86_PLATFORM
#define USE_OPENVINO
{% endif %}

// Compiler-specific optimizations
#ifdef __GNUC__
#define FORCE_INLINE __attribute__((always_inline)) inline
#elif defined(_MSC_VER)
#define FORCE_INLINE __forceinline
#else
#define FORCE_INLINE inline
#endif 